/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => InterlinearPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_state = require("@codemirror/state");
var import_view = require("@codemirror/view");
var LANGUAGES = {
  "es": "Spanish",
  "en": "English",
  "fr": "French",
  "de": "German",
  "it": "Italian",
  "pt": "Portuguese",
  "ru": "Russian",
  "ja": "Japanese",
  "zh": "Chinese (Simplified)",
  "ko": "Korean",
  "ar": "Arabic",
  "hi": "Hindi",
  "tr": "Turkish",
  "nl": "Dutch",
  "pl": "Polish",
  "sv": "Swedish",
  "uk": "Ukrainian",
  "ca": "Catalan",
  "eu": "Basque",
  "gl": "Galician"
};
var DEFAULT_SETTINGS = {
  provider: "google_free",
  targetLang: "es",
  apiKey: "",
  ollamaModel: "qwen2.5:0.5b",
  secondaryColor: "#2ea44f",
  secondarySize: "14px",
  isActive: true,
  savedTranslations: {},
  monthlyCharacterLimit: 5e5,
  alertThresholdPercent: 80,
  currentMonthChars: 0,
  lastResetMonth: new Date().toISOString().slice(0, 7),
  dontAskConfirmClear: false
};
var InterlinearPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.translationCache = /* @__PURE__ */ new Map();
    this.requestQueue = [];
    this.isProcessingQueue = false;
    this.ribbonIconEl = null;
    this.statusBarItemEl = null;
    this.saveCacheToDisk = (0, import_obsidian.debounce)(async () => {
      this.settings.savedTranslations = Object.fromEntries(this.translationCache);
      await this.saveData(this.settings);
    }, 5e3, true);
  }
  async onload() {
    await this.loadSettings();
    this.translationCache = new Map(Object.entries(this.settings.savedTranslations || {}));
    this.checkMonthlyReset();
    this.addCommand({
      id: "toggle-translator-current-file",
      name: "Activar/Desactivar traductor SOLO en esta nota",
      callback: () => this.toggleTranslationForActiveFile()
    });
    this.addCommand({
      id: "set-language-current-file",
      name: "Cambiar idioma de traducci\xF3n para esta nota...",
      callback: () => this.openLanguageModalForActiveFile()
    });
    this.addCommand({
      id: "toggle-translator",
      name: "Toggle Translator On/Off (Global)",
      hotkeys: [{ modifiers: ["Alt", "Shift"], key: "t" }],
      callback: () => this.togglePluginStatus()
    });
    this.statusBarItemEl = this.addStatusBarItem();
    this.statusBarItemEl.addClass("mod-clickable");
    this.statusBarItemEl.addEventListener("click", () => this.openLanguageModalForActiveFile());
    this.updateStatusBar();
    this.ribbonIconEl = this.addRibbonIcon("languages", "Interlinear Translator", () => this.togglePluginStatus());
    this.updateRibbonIcon();
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        if (file instanceof import_obsidian.TFile && file.extension === "md") {
          menu.addSeparator();
          menu.addItem((item) => {
            item.setTitle("\u{1F310} Traductor: Cambiar idioma").setIcon("languages").onClick(() => {
              new LanguageSuggestModal(this.app, this, file).open();
            });
          });
          menu.addItem((item) => {
            item.setTitle("\u26A1 Traductor: Activar/Desactivar").setIcon("power").onClick(async () => {
              await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
                if (frontmatter.hasOwnProperty("translate")) {
                  frontmatter["translate"] = !frontmatter["translate"];
                } else {
                  frontmatter["translate"] = !this.settings.isActive;
                }
                new import_obsidian.Notice(frontmatter["translate"] ? "\u{1F7E2} Traductor ACTIVADO para esta nota" : "\u{1F534} Traductor DESACTIVADO para esta nota");
              });
              this.app.workspace.updateOptions();
            });
          });
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        menu.addSeparator();
        menu.addItem((item) => {
          item.setTitle("\u{1F310} Traductor: Cambiar idioma de esta nota").setIcon("languages").onClick(() => {
            this.openLanguageModalForActiveFile();
          });
        });
      })
    );
    this.registerEditorExtension(this.liveTranslationExtension());
    this.addSettingTab(new InterlinearSettingTab(this.app, this));
  }
  // --- RASTREADOR DE PROPIEDADES (FRONTMATTER) ---
  getFileSettings() {
    let localIsActive = this.settings.isActive;
    let localTargetLang = this.settings.targetLang;
    const activeFile = this.app.workspace.getActiveFile();
    if (activeFile) {
      const cache = this.app.metadataCache.getFileCache(activeFile);
      const frontmatter = cache == null ? void 0 : cache.frontmatter;
      if (frontmatter) {
        if (frontmatter.hasOwnProperty("translate")) {
          localIsActive = frontmatter["translate"] === true;
        }
        if (frontmatter.hasOwnProperty("target_lang")) {
          localTargetLang = frontmatter["target_lang"];
        }
      }
    }
    return { isActive: localIsActive, targetLang: localTargetLang };
  }
  async toggleTranslationForActiveFile() {
    const file = this.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian.Notice("\u26A0\uFE0F No se ha encontrado ninguna nota activa.");
      return;
    }
    await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      if (frontmatter.hasOwnProperty("translate")) {
        frontmatter["translate"] = !frontmatter["translate"];
      } else {
        frontmatter["translate"] = !this.settings.isActive;
      }
      new import_obsidian.Notice(frontmatter["translate"] ? "\u{1F7E2} Traductor ACTIVADO para esta nota" : "\u{1F534} Traductor DESACTIVADO para esta nota");
    });
    this.app.workspace.updateOptions();
  }
  openLanguageModalForActiveFile() {
    const file = this.app.workspace.getActiveFile();
    if (!file) {
      new import_obsidian.Notice("\u26A0\uFE0F No se ha encontrado ninguna nota activa.");
      return;
    }
    new LanguageSuggestModal(this.app, this, file).open();
  }
  checkMonthlyReset() {
    const currentMonth = new Date().toISOString().slice(0, 7);
    if (this.settings.lastResetMonth !== currentMonth) {
      this.settings.currentMonthChars = 0;
      this.settings.lastResetMonth = currentMonth;
      this.saveSettings();
      new import_obsidian.Notice("\u{1F4C5} New Month: API Usage Counter Reset.");
    }
  }
  async togglePluginStatus() {
    this.settings.isActive = !this.settings.isActive;
    await this.saveSettings();
    this.updateRibbonIcon();
    this.updateStatusBar();
    new import_obsidian.Notice(this.settings.isActive ? `Translator: ON (${this.getProviderName()})` : "Translator: OFF");
    this.app.workspace.updateOptions();
  }
  getProviderName() {
    switch (this.settings.provider) {
      case "google_free":
        return "Free";
      case "google_api":
        return "PRO";
      case "local_ollama":
        return "Local";
    }
  }
  updateStatusBar() {
    if (!this.statusBarItemEl)
      return;
    const { isActive, targetLang } = this.getFileSettings();
    if (!isActive) {
      this.statusBarItemEl.setText("\u{1F515} Traductor: Apagado");
      this.statusBarItemEl.style.color = "";
    } else {
      const mode = this.settings.provider;
      let icon = "\u{1F7E2}";
      let color = "#66ff66";
      if (mode === "google_api") {
        icon = "\u26A1";
        color = "#ffcc00";
      }
      if (mode === "local_ollama") {
        icon = "\u{1F512}";
        color = "#00ffff";
      }
      this.statusBarItemEl.setText(`${icon} a ${LANGUAGES[targetLang] || targetLang}`);
      this.statusBarItemEl.style.color = color;
    }
  }
  updateRibbonIcon() {
    if (!this.ribbonIconEl)
      return;
    this.settings.isActive ? this.ribbonIconEl.style.opacity = "1" : this.ribbonIconEl.style.opacity = "0.4";
  }
  liveTranslationExtension() {
    return import_state.StateField.define({
      create: () => import_view.Decoration.none,
      update: (decorations, transaction) => {
        const { isActive, targetLang } = this.getFileSettings();
        this.updateStatusBar();
        if (!isActive)
          return import_view.Decoration.none;
        return this.getDecorations(transaction.state.doc, targetLang);
      },
      provide: (field) => import_view.EditorView.decorations.from(field)
    });
  }
  getDecorations(doc, currentLang) {
    const builder = new import_state.RangeSetBuilder();
    for (let i = 1; i <= doc.lines; i++) {
      const line = doc.line(i);
      const text = line.text.trim();
      if (text.length < 3 || text.startsWith("```") || text.startsWith("$$"))
        continue;
      const cacheKey = `${text}_${currentLang}_${this.settings.provider}`;
      let translatedText = "...";
      let isWaiting = true;
      if (this.translationCache.has(cacheKey)) {
        translatedText = this.translationCache.get(cacheKey) || "";
        isWaiting = false;
      } else {
        this.addToQueue(text, currentLang);
      }
      builder.add(line.to, line.to, import_view.Decoration.widget({
        widget: new TranslationWidget(translatedText, this.settings, isWaiting),
        side: 1,
        block: true
      }));
    }
    return builder.finish();
  }
  addToQueue(text, lang) {
    if (!this.requestQueue.find((item) => item.text === text && item.lang === lang)) {
      this.requestQueue.push({ text, lang });
      this.processQueue();
    }
  }
  async processQueue() {
    if (this.isProcessingQueue)
      return;
    this.isProcessingQueue = true;
    while (this.requestQueue.length > 0) {
      const request = this.requestQueue[0];
      const textToTranslate = request.text;
      const targetLang = request.lang;
      const cacheKey = `${textToTranslate}_${targetLang}_${this.settings.provider}`;
      let delay = 800;
      if (this.settings.provider === "google_api")
        delay = 200;
      if (this.settings.provider === "local_ollama")
        delay = 300;
      await sleep(delay);
      if (!this.translationCache.has(cacheKey)) {
        try {
          let result = "";
          if (this.settings.provider === "local_ollama") {
            result = await this.translateLocal(textToTranslate, targetLang);
          } else if (this.settings.provider === "google_api") {
            result = await this.translateGooglePro(textToTranslate, targetLang);
          } else {
            result = await this.translateGoogleFree(textToTranslate, targetLang);
          }
          const esError = result.startsWith("\u26A0\uFE0F") || result.includes("Error") || result.includes("Key");
          if (!esError) {
            this.translationCache.set(cacheKey, result);
            this.saveCacheToDisk();
          }
          try {
            this.app.workspace.updateOptions();
          } catch (e) {
          }
        } catch (error) {
          await sleep(2e3);
        }
      }
      this.requestQueue.shift();
    }
    this.isProcessingQueue = false;
  }
  async translateGoogleFree(text, targetLang) {
    var _a;
    try {
      const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
      const response = await (0, import_obsidian.requestUrl)({ url });
      const translationParts = (_a = response.json) == null ? void 0 : _a[0];
      if (!translationParts || !Array.isArray(translationParts))
        return "Error de formato Google";
      let fullTranslation = "";
      for (let i = 0; i < translationParts.length; i++) {
        const part = translationParts[i];
        if (Array.isArray(part) && typeof part[0] === "string") {
          fullTranslation += part[0];
        }
      }
      return fullTranslation.trim() || "Error al unir frases";
    } catch (error) {
      console.error("Traductor - Error en Google Free:", error);
      return "\u26A0\uFE0F Error de conexi\xF3n Free";
    }
  }
  async translateGooglePro(text, targetLang) {
    var _a, _b, _c, _d;
    if (!this.settings.apiKey)
      return "\u26A0\uFE0F Missing API Key";
    const limit = this.settings.monthlyCharacterLimit;
    const current = this.settings.currentMonthChars;
    const threshold = this.settings.alertThresholdPercent / 100 * limit;
    if (current < threshold && current + text.length >= threshold) {
      new import_obsidian.Notice(`\u26A0\uFE0F USAGE ALERT: You have crossed ${this.settings.alertThresholdPercent}% of your monthly quota.`);
    }
    const url = `https://translation.googleapis.com/language/translate/v2?key=${this.settings.apiKey}`;
    const response = await (0, import_obsidian.requestUrl)({
      url,
      method: "POST",
      body: JSON.stringify({ q: text, target: targetLang, format: "text" })
    });
    const translated = (_d = (_c = (_b = (_a = response.json) == null ? void 0 : _a.data) == null ? void 0 : _b.translations) == null ? void 0 : _c[0]) == null ? void 0 : _d.translatedText;
    if (translated) {
      this.settings.currentMonthChars += text.length;
      this.updateStatusBar();
      await this.saveData(this.settings);
    }
    return translated || "Error API";
  }
  async translateLocal(text, targetLang) {
    var _a, _b;
    const fullLangName = LANGUAGES[targetLang] || targetLang;
    const systemPrompt = `Translate to ${fullLangName}. Output ONLY translation.`;
    try {
      const response = await (0, import_obsidian.requestUrl)({
        url: "http://localhost:11434/api/generate",
        method: "POST",
        body: JSON.stringify({
          model: this.settings.ollamaModel,
          system: systemPrompt,
          prompt: text,
          stream: false,
          options: { temperature: 0.1 }
        })
      });
      return ((_b = (_a = response.json) == null ? void 0 : _a.response) == null ? void 0 : _b.trim()) || "Error Local";
    } catch (e) {
      return "\u26A0\uFE0F Open Ollama App";
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.app.workspace.updateOptions();
    this.updateRibbonIcon();
    this.updateStatusBar();
  }
};
var TranslationWidget = class extends import_view.WidgetType {
  constructor(text, settings, isWaiting) {
    super();
    this.text = text;
    this.settings = settings;
    this.isWaiting = isWaiting;
  }
  toDOM(view) {
    const div = document.createElement("div");
    div.className = "interlinear-widget";
    const esError = this.text.startsWith("\u26A0\uFE0F");
    if (this.isWaiting && !this.text) {
      div.innerText = "\u23F3";
      div.style.opacity = "0.5";
    } else {
      const txt = new DOMParser().parseFromString(this.text, "text/html").documentElement.textContent;
      div.innerText = txt || "";
      if (esError) {
        div.style.color = "#ff4444";
        div.style.fontSize = "12px";
      } else {
        div.style.color = this.settings.secondaryColor;
        div.style.fontSize = this.settings.secondarySize;
      }
    }
    return div;
  }
};
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, plugin, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: "\u26A0\uFE0F Clear Database?" });
    contentEl.createEl("p", { text: "This will delete all saved translations. This action cannot be undone." });
    const div = contentEl.createDiv();
    const checkbox = div.createEl("input", { type: "checkbox" });
    div.createEl("span", { text: " Don't ask again (Always confirm)" });
    div.style.marginBottom = "20px";
    const buttonContainer = contentEl.createDiv();
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "10px";
    buttonContainer.style.justifyContent = "flex-end";
    const btnCancel = buttonContainer.createEl("button", { text: "Cancel" });
    btnCancel.onClickEvent(() => {
      this.close();
    });
    const btnConfirm = buttonContainer.createEl("button", { text: "Yes, Delete" });
    btnConfirm.classList.add("mod-warning");
    btnConfirm.onClickEvent(() => {
      this.onSubmit(true, checkbox.checked);
      this.close();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var InterlinearSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u{1F30D} Interlinear Translator Settings" });
    new import_obsidian.Setting(containerEl).setName("\u{1F5D1}\uFE0F Clear Database").setDesc("Deletes all saved translations to free up space or fix errors.").addButton((button) => button.setButtonText("Clear Memory").setWarning().onClick(async () => {
      if (this.plugin.settings.dontAskConfirmClear) {
        this.clearDatabase();
      } else {
        new ConfirmModal(this.app, this.plugin, (result, dontAsk) => {
          if (result) {
            if (dontAsk) {
              this.plugin.settings.dontAskConfirmClear = true;
              this.plugin.saveSettings();
            }
            this.clearDatabase();
          }
        }).open();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Translation Mode").addDropdown((d) => d.addOption("google_free", "\u{1F7E2} Basic (Free - Slow)").addOption("google_api", "\u26A1 Pro (API Key - Fast)").addOption("local_ollama", "\u{1F512} Private (Ollama - Local)").setValue(this.plugin.settings.provider).onChange(async (v) => {
      this.plugin.settings.provider = v;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.provider === "google_api") {
      containerEl.createEl("h3", { text: "\u{1F4B0} Cost Control (Pro Mode)" });
      new import_obsidian.Setting(containerEl).setName("\u{1F511} Google API Key").addText((t) => t.setValue(this.plugin.settings.apiKey).onChange(async (v) => {
        this.plugin.settings.apiKey = v;
        await this.plugin.saveSettings();
      }));
      new import_obsidian.Setting(containerEl).setName("\u{1F4CA} Characters Used (Month)").addText((t) => t.setValue(this.plugin.settings.currentMonthChars.toString()).setDisabled(true));
      new import_obsidian.Setting(containerEl).setName("\u{1F514} Usage Warning Threshold (%)").setDesc("Notify me when usage reaches this percentage (0-100).").addText((text) => text.setPlaceholder("80.00").setValue(this.plugin.settings.alertThresholdPercent.toFixed(2)).onChange(async (value) => {
        let num = parseFloat(value);
        if (isNaN(num))
          return;
        if (num < 0)
          num = 0;
        if (num > 100)
          num = 100;
        this.plugin.settings.alertThresholdPercent = num;
        await this.plugin.saveSettings();
      }));
    }
    if (this.plugin.settings.provider === "local_ollama") {
      new import_obsidian.Setting(containerEl).setName("\u{1F916} Ollama Model").addText((t) => t.setValue(this.plugin.settings.ollamaModel).onChange(async (v) => {
        this.plugin.settings.ollamaModel = v;
        await this.plugin.saveSettings();
      }));
    }
    containerEl.createEl("h3", { text: "\u{1F3A8} Appearance" });
    new import_obsidian.Setting(containerEl).setName("Target Language (Global)").addDropdown((dropdown) => {
      const sortedLangs = Object.entries(LANGUAGES).sort((a, b) => a[1].localeCompare(b[1]));
      sortedLangs.forEach(([code, name]) => dropdown.addOption(code, name));
      dropdown.setValue(this.plugin.settings.targetLang);
      dropdown.onChange(async (value) => {
        this.plugin.settings.targetLang = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Text Color").addColorPicker((c) => c.setValue(this.plugin.settings.secondaryColor).onChange(async (v) => {
      this.plugin.settings.secondaryColor = v;
      await this.plugin.saveSettings();
    }));
  }
  async clearDatabase() {
    this.plugin.settings.savedTranslations = {};
    this.plugin.translationCache.clear();
    await this.plugin.saveSettings();
    new import_obsidian.Notice("\u2705 Memory cleared successfully.");
    this.plugin.app.workspace.updateOptions();
  }
};
var LanguageSuggestModal = class extends import_obsidian.SuggestModal {
  constructor(app, plugin, file) {
    super(app);
    this.plugin = plugin;
    this.file = file;
    this.setPlaceholder("Buscar idioma (ej. Spanish, en, fr...)");
  }
  getSuggestions(query) {
    const queryLower = query.toLowerCase();
    return Object.keys(LANGUAGES).filter(
      (code) => LANGUAGES[code].toLowerCase().includes(queryLower) || code.includes(queryLower)
    );
  }
  renderSuggestion(code, el) {
    el.createEl("div", { text: LANGUAGES[code] });
    el.createEl("small", { text: `C\xF3digo: ${code}`, cls: "text-muted" });
  }
  async onChooseSuggestion(code, evt) {
    await this.plugin.app.fileManager.processFrontMatter(this.file, (frontmatter) => {
      frontmatter["target_lang"] = code;
    });
    new import_obsidian.Notice(`\u{1F3AF} Idioma establecido a: ${LANGUAGES[code]} para esta nota`);
    this.plugin.app.workspace.updateOptions();
  }
};
function sleep(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIHJlcXVlc3RVcmwsIE5vdGljZSwgZGVib3VuY2UsIE1vZGFsLCBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFeHRlbnNpb24sIFN0YXRlRmllbGQsIFJhbmdlU2V0QnVpbGRlciB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xyXG5pbXBvcnQgeyBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0LCBFZGl0b3JWaWV3LCBXaWRnZXRUeXBlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcclxuXHJcbi8vIC0tLSBMQU5HVUFHRSBMSVNUIChJU08gNjM5LTEpIC0tLVxyXG5jb25zdCBMQU5HVUFHRVM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XHJcbiAgICAnZXMnOiAnU3BhbmlzaCcsICdlbic6ICdFbmdsaXNoJywgJ2ZyJzogJ0ZyZW5jaCcsICdkZSc6ICdHZXJtYW4nLFxyXG4gICAgJ2l0JzogJ0l0YWxpYW4nLCAncHQnOiAnUG9ydHVndWVzZScsICdydSc6ICdSdXNzaWFuJywgJ2phJzogJ0phcGFuZXNlJyxcclxuICAgICd6aCc6ICdDaGluZXNlIChTaW1wbGlmaWVkKScsICdrbyc6ICdLb3JlYW4nLCAnYXInOiAnQXJhYmljJyxcclxuICAgICdoaSc6ICdIaW5kaScsICd0cic6ICdUdXJraXNoJywgJ25sJzogJ0R1dGNoJywgJ3BsJzogJ1BvbGlzaCcsXHJcbiAgICAnc3YnOiAnU3dlZGlzaCcsICd1ayc6ICdVa3JhaW5pYW4nLCAnY2EnOiAnQ2F0YWxhbicsICdldSc6ICdCYXNxdWUnLFxyXG4gICAgJ2dsJzogJ0dhbGljaWFuJ1xyXG59O1xyXG5cclxudHlwZSBUcmFuc2xhdGlvblByb3ZpZGVyID0gJ2dvb2dsZV9mcmVlJyB8ICdnb29nbGVfYXBpJyB8ICdsb2NhbF9vbGxhbWEnO1xyXG5cclxuaW50ZXJmYWNlIEludGVybGluZWFyU2V0dGluZ3Mge1xyXG4gICAgcHJvdmlkZXI6IFRyYW5zbGF0aW9uUHJvdmlkZXI7XHJcbiAgICB0YXJnZXRMYW5nOiBzdHJpbmc7XHJcbiAgICBhcGlLZXk6IHN0cmluZztcclxuICAgIG9sbGFtYU1vZGVsOiBzdHJpbmc7XHJcbiAgICBzZWNvbmRhcnlDb2xvcjogc3RyaW5nO1xyXG4gICAgc2Vjb25kYXJ5U2l6ZTogc3RyaW5nO1xyXG4gICAgaXNBY3RpdmU6IGJvb2xlYW47XHJcbiAgICBzYXZlZFRyYW5zbGF0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcclxuICAgIG1vbnRobHlDaGFyYWN0ZXJMaW1pdDogbnVtYmVyO1xyXG4gICAgYWxlcnRUaHJlc2hvbGRQZXJjZW50OiBudW1iZXI7XHJcbiAgICBjdXJyZW50TW9udGhDaGFyczogbnVtYmVyO1xyXG4gICAgbGFzdFJlc2V0TW9udGg6IHN0cmluZztcclxuICAgIGRvbnRBc2tDb25maXJtQ2xlYXI6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEludGVybGluZWFyU2V0dGluZ3MgPSB7XHJcbiAgICBwcm92aWRlcjogJ2dvb2dsZV9mcmVlJyxcclxuICAgIHRhcmdldExhbmc6ICdlcycsXHJcbiAgICBhcGlLZXk6ICcnLFxyXG4gICAgb2xsYW1hTW9kZWw6ICdxd2VuMi41OjAuNWInLFxyXG4gICAgc2Vjb25kYXJ5Q29sb3I6ICcjMmVhNDRmJyxcclxuICAgIHNlY29uZGFyeVNpemU6ICcxNHB4JyxcclxuICAgIGlzQWN0aXZlOiB0cnVlLFxyXG4gICAgc2F2ZWRUcmFuc2xhdGlvbnM6IHt9LFxyXG4gICAgbW9udGhseUNoYXJhY3RlckxpbWl0OiA1MDAwMDAsXHJcbiAgICBhbGVydFRocmVzaG9sZFBlcmNlbnQ6IDgwLjAwLFxyXG4gICAgY3VycmVudE1vbnRoQ2hhcnM6IDAsXHJcbiAgICBsYXN0UmVzZXRNb250aDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDcpLFxyXG4gICAgZG9udEFza0NvbmZpcm1DbGVhcjogZmFsc2VcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW50ZXJsaW5lYXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gICAgc2V0dGluZ3M6IEludGVybGluZWFyU2V0dGluZ3M7XHJcbiAgICB0cmFuc2xhdGlvbkNhY2hlOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xyXG4gICAgcmVxdWVzdFF1ZXVlOiB7IHRleHQ6IHN0cmluZywgbGFuZzogc3RyaW5nIH1bXSA9IFtdOyBcclxuICAgIGlzUHJvY2Vzc2luZ1F1ZXVlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICByaWJib25JY29uRWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICBzdGF0dXNCYXJJdGVtRWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcbiAgICAgICAgdGhpcy50cmFuc2xhdGlvbkNhY2hlID0gbmV3IE1hcChPYmplY3QuZW50cmllcyh0aGlzLnNldHRpbmdzLnNhdmVkVHJhbnNsYXRpb25zIHx8IHt9KSk7XHJcbiAgICAgICAgdGhpcy5jaGVja01vbnRobHlSZXNldCgpO1xyXG5cclxuICAgICAgICAvLyAtLS0gQ09NQU5ET1MgUlx1MDBDMVBJRE9TIC0tLVxyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLXRyYW5zbGF0b3ItY3VycmVudC1maWxlJyxcclxuICAgICAgICAgICAgbmFtZTogJ0FjdGl2YXIvRGVzYWN0aXZhciB0cmFkdWN0b3IgU09MTyBlbiBlc3RhIG5vdGEnLFxyXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy50b2dnbGVUcmFuc2xhdGlvbkZvckFjdGl2ZUZpbGUoKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3NldC1sYW5ndWFnZS1jdXJyZW50LWZpbGUnLFxyXG4gICAgICAgICAgICBuYW1lOiAnQ2FtYmlhciBpZGlvbWEgZGUgdHJhZHVjY2lcdTAwRjNuIHBhcmEgZXN0YSBub3RhLi4uJyxcclxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMub3Blbkxhbmd1YWdlTW9kYWxGb3JBY3RpdmVGaWxlKClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICAgICAgaWQ6ICd0b2dnbGUtdHJhbnNsYXRvcicsXHJcbiAgICAgICAgICAgIG5hbWU6ICdUb2dnbGUgVHJhbnNsYXRvciBPbi9PZmYgKEdsb2JhbCknLFxyXG4gICAgICAgICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFtcIkFsdFwiLCBcIlNoaWZ0XCJdLCBrZXk6IFwidFwiIH1dLCBcclxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMudG9nZ2xlUGx1Z2luU3RhdHVzKClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gLS0tIEJBUlJBIERFIEVTVEFETyBDTElDQUJMRSAtLS1cclxuICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW1FbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xyXG4gICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbUVsLmFkZENsYXNzKFwibW9kLWNsaWNrYWJsZVwiKTtcclxuICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTGFuZ3VhZ2VNb2RhbEZvckFjdGl2ZUZpbGUoKSk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIElDT05PIExBVEVSQUwgLS0tXHJcbiAgICAgICAgdGhpcy5yaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oJ2xhbmd1YWdlcycsICdJbnRlcmxpbmVhciBUcmFuc2xhdG9yJywgKCkgPT4gdGhpcy50b2dnbGVQbHVnaW5TdGF0dXMoKSk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVSaWJib25JY29uKCk7XHJcblxyXG4gICAgICAgIC8vIC0tLSBNRU5cdTAwREEgREUgTE9TIDMgUFVOVElUT1MgWSBFWFBMT1JBRE9SIC0tLVxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1tZW51XCIsIChtZW51LCBmaWxlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZFNlcGFyYXRvcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKFwiXHVEODNDXHVERjEwIFRyYWR1Y3RvcjogQ2FtYmlhciBpZGlvbWFcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwibGFuZ3VhZ2VzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExhbmd1YWdlU3VnZ2VzdE1vZGFsKHRoaXMuYXBwLCB0aGlzLCBmaWxlKS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShcIlx1MjZBMSBUcmFkdWN0b3I6IEFjdGl2YXIvRGVzYWN0aXZhclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJwb3dlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyLmhhc093blByb3BlcnR5KCd0cmFuc2xhdGUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJbJ3RyYW5zbGF0ZSddID0gIWZyb250bWF0dGVyWyd0cmFuc2xhdGUnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyWyd0cmFuc2xhdGUnXSA9ICF0aGlzLnNldHRpbmdzLmlzQWN0aXZlOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGZyb250bWF0dGVyWyd0cmFuc2xhdGUnXSA/IFwiXHVEODNEXHVERkUyIFRyYWR1Y3RvciBBQ1RJVkFETyBwYXJhIGVzdGEgbm90YVwiIDogXCJcdUQ4M0RcdUREMzQgVHJhZHVjdG9yIERFU0FDVElWQURPIHBhcmEgZXN0YSBub3RhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS51cGRhdGVPcHRpb25zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyAtLS0gTUVOXHUwMERBIERFIENMSUMgREVSRUNITyBFTiBFTCBURVhUTyAtLS1cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImVkaXRvci1tZW51XCIsIChtZW51LCBlZGl0b3IsIHZpZXcpID0+IHtcclxuICAgICAgICAgICAgICAgIG1lbnUuYWRkU2VwYXJhdG9yKCk7XHJcbiAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKFwiXHVEODNDXHVERjEwIFRyYWR1Y3RvcjogQ2FtYmlhciBpZGlvbWEgZGUgZXN0YSBub3RhXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwibGFuZ3VhZ2VzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3Blbkxhbmd1YWdlTW9kYWxGb3JBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gLS0tIENBUkdBIEZJTkFMIC0tLVxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24odGhpcy5saXZlVHJhbnNsYXRpb25FeHRlbnNpb24oKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBJbnRlcmxpbmVhclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0gUkFTVFJFQURPUiBERSBQUk9QSUVEQURFUyAoRlJPTlRNQVRURVIpIC0tLVxyXG4gICAgZ2V0RmlsZVNldHRpbmdzKCk6IHsgaXNBY3RpdmU6IGJvb2xlYW4sIHRhcmdldExhbmc6IHN0cmluZyB9IHtcclxuICAgICAgICBsZXQgbG9jYWxJc0FjdGl2ZSA9IHRoaXMuc2V0dGluZ3MuaXNBY3RpdmU7XHJcbiAgICAgICAgbGV0IGxvY2FsVGFyZ2V0TGFuZyA9IHRoaXMuc2V0dGluZ3MudGFyZ2V0TGFuZztcclxuXHJcbiAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZUZpbGUpIHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XHJcblxyXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlci5oYXNPd25Qcm9wZXJ0eSgndHJhbnNsYXRlJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbElzQWN0aXZlID0gZnJvbnRtYXR0ZXJbJ3RyYW5zbGF0ZSddID09PSB0cnVlOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlci5oYXNPd25Qcm9wZXJ0eSgndGFyZ2V0X2xhbmcnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsVGFyZ2V0TGFuZyA9IGZyb250bWF0dGVyWyd0YXJnZXRfbGFuZyddO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGlzQWN0aXZlOiBsb2NhbElzQWN0aXZlLCB0YXJnZXRMYW5nOiBsb2NhbFRhcmdldExhbmcgfTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyB0b2dnbGVUcmFuc2xhdGlvbkZvckFjdGl2ZUZpbGUoKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgaWYgKCFmaWxlKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdTI2QTBcdUZFMEYgTm8gc2UgaGEgZW5jb250cmFkbyBuaW5ndW5hIG5vdGEgYWN0aXZhLlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIChmcm9udG1hdHRlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXIuaGFzT3duUHJvcGVydHkoJ3RyYW5zbGF0ZScpKSB7XHJcbiAgICAgICAgICAgICAgICBmcm9udG1hdHRlclsndHJhbnNsYXRlJ10gPSAhZnJvbnRtYXR0ZXJbJ3RyYW5zbGF0ZSddO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJbJ3RyYW5zbGF0ZSddID0gIXRoaXMuc2V0dGluZ3MuaXNBY3RpdmU7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoZnJvbnRtYXR0ZXJbJ3RyYW5zbGF0ZSddID8gXCJcdUQ4M0RcdURGRTIgVHJhZHVjdG9yIEFDVElWQURPIHBhcmEgZXN0YSBub3RhXCIgOiBcIlx1RDgzRFx1REQzNCBUcmFkdWN0b3IgREVTQUNUSVZBRE8gcGFyYSBlc3RhIG5vdGFcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnVwZGF0ZU9wdGlvbnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuTGFuZ3VhZ2VNb2RhbEZvckFjdGl2ZUZpbGUoKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgaWYgKCFmaWxlKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdTI2QTBcdUZFMEYgTm8gc2UgaGEgZW5jb250cmFkbyBuaW5ndW5hIG5vdGEgYWN0aXZhLlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXcgTGFuZ3VhZ2VTdWdnZXN0TW9kYWwodGhpcy5hcHAsIHRoaXMsIGZpbGUpLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja01vbnRobHlSZXNldCgpIHtcclxuICAgICAgICBjb25zdCBjdXJyZW50TW9udGggPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgNyk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MubGFzdFJlc2V0TW9udGggIT09IGN1cnJlbnRNb250aCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmN1cnJlbnRNb250aENoYXJzID0gMDtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5sYXN0UmVzZXRNb250aCA9IGN1cnJlbnRNb250aDtcclxuICAgICAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIlx1RDgzRFx1RENDNSBOZXcgTW9udGg6IEFQSSBVc2FnZSBDb3VudGVyIFJlc2V0LlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdG9nZ2xlUGx1Z2luU3RhdHVzKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuaXNBY3RpdmUgPSAhdGhpcy5zZXR0aW5ncy5pc0FjdGl2ZTtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlUmliYm9uSWNvbigpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XHJcbiAgICAgICAgbmV3IE5vdGljZSh0aGlzLnNldHRpbmdzLmlzQWN0aXZlID8gYFRyYW5zbGF0b3I6IE9OICgke3RoaXMuZ2V0UHJvdmlkZXJOYW1lKCl9KWAgOiBcIlRyYW5zbGF0b3I6IE9GRlwiKTtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UudXBkYXRlT3B0aW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFByb3ZpZGVyTmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHN3aXRjaCh0aGlzLnNldHRpbmdzLnByb3ZpZGVyKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dvb2dsZV9mcmVlJzogcmV0dXJuIFwiRnJlZVwiO1xyXG4gICAgICAgICAgICBjYXNlICdnb29nbGVfYXBpJzogcmV0dXJuIFwiUFJPXCI7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xvY2FsX29sbGFtYSc6IHJldHVybiBcIkxvY2FsXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVN0YXR1c0JhcigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc3RhdHVzQmFySXRlbUVsKSByZXR1cm47XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgeyBpc0FjdGl2ZSwgdGFyZ2V0TGFuZyB9ID0gdGhpcy5nZXRGaWxlU2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgaWYgKCFpc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KFwiXHVEODNEXHVERDE1IFRyYWR1Y3RvcjogQXBhZ2Fkb1wiKTtcclxuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtRWwuc3R5bGUuY29sb3IgPSBcIlwiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGUgPSB0aGlzLnNldHRpbmdzLnByb3ZpZGVyO1xyXG4gICAgICAgICAgICBsZXQgaWNvbiA9IFwiXHVEODNEXHVERkUyXCI7XHJcbiAgICAgICAgICAgIGxldCBjb2xvciA9IFwiIzY2ZmY2NlwiO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdnb29nbGVfYXBpJykgeyBpY29uID0gXCJcdTI2QTFcIjsgY29sb3IgPSBcIiNmZmNjMDBcIjsgfVxyXG4gICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2xvY2FsX29sbGFtYScpIHsgaWNvbiA9IFwiXHVEODNEXHVERDEyXCI7IGNvbG9yID0gXCIjMDBmZmZmXCI7IH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbUVsLnNldFRleHQoYCR7aWNvbn0gYSAke0xBTkdVQUdFU1t0YXJnZXRMYW5nXSB8fCB0YXJnZXRMYW5nfWApO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW1FbC5zdHlsZS5jb2xvciA9IGNvbG9yO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVSaWJib25JY29uKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5yaWJib25JY29uRWwpIHJldHVybjtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLmlzQWN0aXZlID8gdGhpcy5yaWJib25JY29uRWwuc3R5bGUub3BhY2l0eSA9IFwiMVwiIDogdGhpcy5yaWJib25JY29uRWwuc3R5bGUub3BhY2l0eSA9IFwiMC40XCI7XHJcbiAgICB9XHJcblxyXG4gICAgc2F2ZUNhY2hlVG9EaXNrID0gZGVib3VuY2UoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3Muc2F2ZWRUcmFuc2xhdGlvbnMgPSBPYmplY3QuZnJvbUVudHJpZXModGhpcy50cmFuc2xhdGlvbkNhY2hlKTtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgfSwgNTAwMCwgdHJ1ZSk7XHJcblxyXG4gICAgbGl2ZVRyYW5zbGF0aW9uRXh0ZW5zaW9uKCk6IEV4dGVuc2lvbiB7XHJcbiAgICAgICAgcmV0dXJuIFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcclxuICAgICAgICAgICAgY3JlYXRlOiAoKSA9PiBEZWNvcmF0aW9uLm5vbmUsXHJcbiAgICAgICAgICAgIHVwZGF0ZTogKGRlY29yYXRpb25zLCB0cmFuc2FjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBpc0FjdGl2ZSwgdGFyZ2V0TGFuZyB9ID0gdGhpcy5nZXRGaWxlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFpc0FjdGl2ZSkgcmV0dXJuIERlY29yYXRpb24ubm9uZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERlY29yYXRpb25zKHRyYW5zYWN0aW9uLnN0YXRlLmRvYywgdGFyZ2V0TGFuZyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHByb3ZpZGU6IGZpZWxkID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmaWVsZClcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREZWNvcmF0aW9ucyhkb2M6IGFueSwgY3VycmVudExhbmc6IHN0cmluZyk6IERlY29yYXRpb25TZXQge1xyXG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gZG9jLmxpbmVzOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgbGluZSA9IGRvYy5saW5lKGkpO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gbGluZS50ZXh0LnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoIDwgMyB8fCB0ZXh0LnN0YXJ0c1dpdGgoXCJgYGBcIikgfHwgdGV4dC5zdGFydHNXaXRoKFwiJCRcIikpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgJHt0ZXh0fV8ke2N1cnJlbnRMYW5nfV8ke3RoaXMuc2V0dGluZ3MucHJvdmlkZXJ9YDtcclxuICAgICAgICAgICAgbGV0IHRyYW5zbGF0ZWRUZXh0ID0gXCIuLi5cIjsgXHJcbiAgICAgICAgICAgIGxldCBpc1dhaXRpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRpb25DYWNoZS5oYXMoY2FjaGVLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2xhdGVkVGV4dCA9IHRoaXMudHJhbnNsYXRpb25DYWNoZS5nZXQoY2FjaGVLZXkpIHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBpc1dhaXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkVG9RdWV1ZSh0ZXh0LCBjdXJyZW50TGFuZyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKGxpbmUudG8sIGxpbmUudG8sIERlY29yYXRpb24ud2lkZ2V0KHtcclxuICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IFRyYW5zbGF0aW9uV2lkZ2V0KHRyYW5zbGF0ZWRUZXh0LCB0aGlzLnNldHRpbmdzLCBpc1dhaXRpbmcpLFxyXG4gICAgICAgICAgICAgICAgc2lkZTogMSwgYmxvY2s6IHRydWUgXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkVG9RdWV1ZSh0ZXh0OiBzdHJpbmcsIGxhbmc6IHN0cmluZykge1xyXG4gICAgICAgIGlmICghdGhpcy5yZXF1ZXN0UXVldWUuZmluZChpdGVtID0+IGl0ZW0udGV4dCA9PT0gdGV4dCAmJiBpdGVtLmxhbmcgPT09IGxhbmcpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdFF1ZXVlLnB1c2goeyB0ZXh0LCBsYW5nIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NRdWV1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBwcm9jZXNzUXVldWUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNQcm9jZXNzaW5nUXVldWUpIHJldHVybjtcclxuICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZ1F1ZXVlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgd2hpbGUgKHRoaXMucmVxdWVzdFF1ZXVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMucmVxdWVzdFF1ZXVlWzBdO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0VG9UcmFuc2xhdGUgPSByZXF1ZXN0LnRleHQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldExhbmcgPSByZXF1ZXN0Lmxhbmc7IFxyXG4gICAgICAgICAgICBjb25zdCBjYWNoZUtleSA9IGAke3RleHRUb1RyYW5zbGF0ZX1fJHt0YXJnZXRMYW5nfV8ke3RoaXMuc2V0dGluZ3MucHJvdmlkZXJ9YDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBkZWxheSA9IDgwMDsgXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnByb3ZpZGVyID09PSAnZ29vZ2xlX2FwaScpIGRlbGF5ID0gMjAwOyBcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucHJvdmlkZXIgPT09ICdsb2NhbF9vbGxhbWEnKSBkZWxheSA9IDMwMDsgXHJcblxyXG4gICAgICAgICAgICBhd2FpdCBzbGVlcChkZWxheSk7IFxyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLnRyYW5zbGF0aW9uQ2FjaGUuaGFzKGNhY2hlS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5wcm92aWRlciA9PT0gJ2xvY2FsX29sbGFtYScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy50cmFuc2xhdGVMb2NhbCh0ZXh0VG9UcmFuc2xhdGUsIHRhcmdldExhbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZXR0aW5ncy5wcm92aWRlciA9PT0gJ2dvb2dsZV9hcGknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMudHJhbnNsYXRlR29vZ2xlUHJvKHRleHRUb1RyYW5zbGF0ZSwgdGFyZ2V0TGFuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy50cmFuc2xhdGVHb29nbGVGcmVlKHRleHRUb1RyYW5zbGF0ZSwgdGFyZ2V0TGFuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVzRXJyb3IgPSByZXN1bHQuc3RhcnRzV2l0aChcIlx1MjZBMFx1RkUwRlwiKSB8fCByZXN1bHQuaW5jbHVkZXMoXCJFcnJvclwiKSB8fCByZXN1bHQuaW5jbHVkZXMoXCJLZXlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlc0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRpb25DYWNoZS5zZXQoY2FjaGVLZXksIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUNhY2hlVG9EaXNrKCk7IFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0cnkgeyB0aGlzLmFwcC53b3Jrc3BhY2UudXBkYXRlT3B0aW9ucygpOyB9IGNhdGNoKGUpe31cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7IGF3YWl0IHNsZWVwKDIwMDApOyB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0UXVldWUuc2hpZnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc1Byb2Nlc3NpbmdRdWV1ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHRyYW5zbGF0ZUdvb2dsZUZyZWUodGV4dDogc3RyaW5nLCB0YXJnZXRMYW5nOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3RyYW5zbGF0ZS5nb29nbGVhcGlzLmNvbS90cmFuc2xhdGVfYS9zaW5nbGU/Y2xpZW50PWd0eCZzbD1hdXRvJnRsPSR7dGFyZ2V0TGFuZ30mZHQ9dCZxPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRleHQpfWA7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7IHVybDogdXJsIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgdHJhbnNsYXRpb25QYXJ0cyA9IHJlc3BvbnNlLmpzb24/LlswXTtcclxuICAgICAgICAgICAgaWYgKCF0cmFuc2xhdGlvblBhcnRzIHx8ICFBcnJheS5pc0FycmF5KHRyYW5zbGF0aW9uUGFydHMpKSByZXR1cm4gXCJFcnJvciBkZSBmb3JtYXRvIEdvb2dsZVwiO1xyXG5cclxuICAgICAgICAgICAgbGV0IGZ1bGxUcmFuc2xhdGlvbiA9IFwiXCI7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJhbnNsYXRpb25QYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFydCA9IHRyYW5zbGF0aW9uUGFydHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJ0KSAmJiB0eXBlb2YgcGFydFswXSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBmdWxsVHJhbnNsYXRpb24gKz0gcGFydFswXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bGxUcmFuc2xhdGlvbi50cmltKCkgfHwgXCJFcnJvciBhbCB1bmlyIGZyYXNlc1wiO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJUcmFkdWN0b3IgLSBFcnJvciBlbiBHb29nbGUgRnJlZTpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gXCJcdTI2QTBcdUZFMEYgRXJyb3IgZGUgY29uZXhpXHUwMEYzbiBGcmVlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHRyYW5zbGF0ZUdvb2dsZVBybyh0ZXh0OiBzdHJpbmcsIHRhcmdldExhbmc6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmFwaUtleSkgcmV0dXJuIFwiXHUyNkEwXHVGRTBGIE1pc3NpbmcgQVBJIEtleVwiO1xyXG5cclxuICAgICAgICBjb25zdCBsaW1pdCA9IHRoaXMuc2V0dGluZ3MubW9udGhseUNoYXJhY3RlckxpbWl0O1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnNldHRpbmdzLmN1cnJlbnRNb250aENoYXJzO1xyXG4gICAgICAgIGNvbnN0IHRocmVzaG9sZCA9ICh0aGlzLnNldHRpbmdzLmFsZXJ0VGhyZXNob2xkUGVyY2VudCAvIDEwMCkgKiBsaW1pdDtcclxuXHJcbiAgICAgICAgaWYgKGN1cnJlbnQgPCB0aHJlc2hvbGQgJiYgKGN1cnJlbnQgKyB0ZXh0Lmxlbmd0aCkgPj0gdGhyZXNob2xkKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1MjZBMFx1RkUwRiBVU0FHRSBBTEVSVDogWW91IGhhdmUgY3Jvc3NlZCAke3RoaXMuc2V0dGluZ3MuYWxlcnRUaHJlc2hvbGRQZXJjZW50fSUgb2YgeW91ciBtb250aGx5IHF1b3RhLmApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vdHJhbnNsYXRpb24uZ29vZ2xlYXBpcy5jb20vbGFuZ3VhZ2UvdHJhbnNsYXRlL3YyP2tleT0ke3RoaXMuc2V0dGluZ3MuYXBpS2V5fWA7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHsgXHJcbiAgICAgICAgICAgIHVybDogdXJsLCBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBxOiB0ZXh0LCB0YXJnZXQ6IHRhcmdldExhbmcsIGZvcm1hdDogJ3RleHQnIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlZCA9IHJlc3BvbnNlLmpzb24/LmRhdGE/LnRyYW5zbGF0aW9ucz8uWzBdPy50cmFuc2xhdGVkVGV4dDtcclxuXHJcbiAgICAgICAgaWYgKHRyYW5zbGF0ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5jdXJyZW50TW9udGhDaGFycyArPSB0ZXh0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTsgXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJhbnNsYXRlZCB8fCBcIkVycm9yIEFQSVwiO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHRyYW5zbGF0ZUxvY2FsKHRleHQ6IHN0cmluZywgdGFyZ2V0TGFuZzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCBmdWxsTGFuZ05hbWUgPSBMQU5HVUFHRVNbdGFyZ2V0TGFuZ10gfHwgdGFyZ2V0TGFuZztcclxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgVHJhbnNsYXRlIHRvICR7ZnVsbExhbmdOYW1lfS4gT3V0cHV0IE9OTFkgdHJhbnNsYXRpb24uYDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNC9hcGkvZ2VuZXJhdGUnLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHRoaXMuc2V0dGluZ3Mub2xsYW1hTW9kZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtOiBzeXN0ZW1Qcm9tcHQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiB0ZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogeyB0ZW1wZXJhdHVyZTogMC4xIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbj8ucmVzcG9uc2U/LnRyaW0oKSB8fCBcIkVycm9yIExvY2FsXCI7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyByZXR1cm4gXCJcdTI2QTBcdUZFMEYgT3BlbiBPbGxhbWEgQXBwXCI7IH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7IHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpOyB9XHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7IGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7IHRoaXMuYXBwLndvcmtzcGFjZS51cGRhdGVPcHRpb25zKCk7IHRoaXMudXBkYXRlUmliYm9uSWNvbigpOyB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpOyB9XHJcbn1cclxuXHJcbi8vIC0tLSBXSURHRVQgLS0tXHJcbmNsYXNzIFRyYW5zbGF0aW9uV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRleHQ6IHN0cmluZywgcHJpdmF0ZSBzZXR0aW5nczogSW50ZXJsaW5lYXJTZXR0aW5ncywgcHJpdmF0ZSBpc1dhaXRpbmc6IGJvb2xlYW4pIHsgc3VwZXIoKTsgfVxyXG4gICAgdG9ET00odmlldzogRWRpdG9yVmlldyk6IEhUTUxFbGVtZW50IHtcclxuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRpdi5jbGFzc05hbWUgPSBcImludGVybGluZWFyLXdpZGdldFwiO1xyXG4gICAgICAgIGNvbnN0IGVzRXJyb3IgPSB0aGlzLnRleHQuc3RhcnRzV2l0aChcIlx1MjZBMFx1RkUwRlwiKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNXYWl0aW5nICYmICF0aGlzLnRleHQpIHtcclxuICAgICAgICAgICAgZGl2LmlubmVyVGV4dCA9IFwiXHUyM0YzXCI7IGRpdi5zdHlsZS5vcGFjaXR5ID0gXCIwLjVcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB0eHQgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRoaXMudGV4dCwgXCJ0ZXh0L2h0bWxcIikuZG9jdW1lbnRFbGVtZW50LnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBkaXYuaW5uZXJUZXh0ID0gdHh0IHx8IFwiXCI7XHJcbiAgICAgICAgICAgIGlmIChlc0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBkaXYuc3R5bGUuY29sb3IgPSBcIiNmZjQ0NDRcIjsgXHJcbiAgICAgICAgICAgICAgICBkaXYuc3R5bGUuZm9udFNpemUgPSBcIjEycHhcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5jb2xvciA9IHRoaXMuc2V0dGluZ3Muc2Vjb25kYXJ5Q29sb3I7XHJcbiAgICAgICAgICAgICAgICBkaXYuc3R5bGUuZm9udFNpemUgPSB0aGlzLnNldHRpbmdzLnNlY29uZGFyeVNpemU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRpdjtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIE1PREFMIERFIENPTkZJUk1BQ0lcdTAwRDNOIC0tLVxyXG5jbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwbHVnaW46IEludGVybGluZWFyUGx1Z2luO1xyXG4gICAgb25TdWJtaXQ6IChyZXN1bHQ6IGJvb2xlYW4sIGRvbnRBc2s6IGJvb2xlYW4pID0+IHZvaWQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSW50ZXJsaW5lYXJQbHVnaW4sIG9uU3VibWl0OiAocmVzdWx0OiBib29sZWFuLCBkb250QXNrOiBib29sZWFuKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJcdTI2QTBcdUZFMEYgQ2xlYXIgRGF0YWJhc2U/XCIgfSk7XHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiVGhpcyB3aWxsIGRlbGV0ZSBhbGwgc2F2ZWQgdHJhbnNsYXRpb25zLiBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLlwiIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBkaXYgPSBjb250ZW50RWwuY3JlYXRlRGl2KCk7XHJcbiAgICAgICAgY29uc3QgY2hlY2tib3ggPSBkaXYuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwiY2hlY2tib3hcIiB9KTtcclxuICAgICAgICBkaXYuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCIgRG9uJ3QgYXNrIGFnYWluIChBbHdheXMgY29uZmlybSlcIiB9KTtcclxuICAgICAgICBkaXYuc3R5bGUubWFyZ2luQm90dG9tID0gXCIyMHB4XCI7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcclxuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xyXG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5nYXAgPSBcIjEwcHhcIjtcclxuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSBcImZsZXgtZW5kXCI7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ0bkNhbmNlbCA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ2FuY2VsXCIgfSk7XHJcbiAgICAgICAgYnRuQ2FuY2VsLm9uQ2xpY2tFdmVudCgoKSA9PiB7IHRoaXMuY2xvc2UoKTsgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ0bkNvbmZpcm0gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlllcywgRGVsZXRlXCIgfSk7XHJcbiAgICAgICAgYnRuQ29uZmlybS5jbGFzc0xpc3QuYWRkKFwibW9kLXdhcm5pbmdcIik7XHJcbiAgICAgICAgYnRuQ29uZmlybS5vbkNsaWNrRXZlbnQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRydWUsIGNoZWNrYm94LmNoZWNrZWQpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIENPTkZJR1VSQUNJXHUwMEQzTiBVSSAtLS1cclxuY2xhc3MgSW50ZXJsaW5lYXJTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IEludGVybGluZWFyUGx1Z2luO1xyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSW50ZXJsaW5lYXJQbHVnaW4pIHsgc3VwZXIoYXBwLCBwbHVnaW4pOyB0aGlzLnBsdWdpbiA9IHBsdWdpbjsgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qge2NvbnRhaW5lckVsfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1x1RDgzQ1x1REYwRCBJbnRlcmxpbmVhciBUcmFuc2xhdG9yIFNldHRpbmdzJ30pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZSgnXHVEODNEXHVEREQxXHVGRTBGIENsZWFyIERhdGFiYXNlJylcclxuICAgICAgICAuc2V0RGVzYygnRGVsZXRlcyBhbGwgc2F2ZWQgdHJhbnNsYXRpb25zIHRvIGZyZWUgdXAgc3BhY2Ugb3IgZml4IGVycm9ycy4nKVxyXG4gICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxyXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgTWVtb3J5JylcclxuICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxyXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZG9udEFza0NvbmZpcm1DbGVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJEYXRhYmFzZSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgQ29uZmlybU1vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbiwgKHJlc3VsdCwgZG9udEFzaykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9udEFzaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRvbnRBc2tDb25maXJtQ2xlYXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckRhdGFiYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJ1RyYW5zbGF0aW9uIE1vZGUnKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZCA9PiBkXHJcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdnb29nbGVfZnJlZScsICdcdUQ4M0RcdURGRTIgQmFzaWMgKEZyZWUgLSBTbG93KScpXHJcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdnb29nbGVfYXBpJywgJ1x1MjZBMSBQcm8gKEFQSSBLZXkgLSBGYXN0KScpXHJcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdsb2NhbF9vbGxhbWEnLCAnXHVEODNEXHVERDEyIFByaXZhdGUgKE9sbGFtYSAtIExvY2FsKScpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgdiA9PiB7IFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyID0gdiBhcyBUcmFuc2xhdGlvblByb3ZpZGVyOyBcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IFxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIgPT09ICdnb29nbGVfYXBpJykge1xyXG4gICAgICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ1x1RDgzRFx1RENCMCBDb3N0IENvbnRyb2wgKFBybyBNb2RlKSd9KTtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJ1x1RDgzRFx1REQxMSBHb29nbGUgQVBJIEtleScpLmFkZFRleHQodCA9PiB0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUtleSkub25DaGFuZ2UoYXN5bmMgdiA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUtleSA9IHY7IGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyB9KSk7XHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdcdUQ4M0RcdURDQ0EgQ2hhcmFjdGVycyBVc2VkIChNb250aCknKS5hZGRUZXh0KHQgPT4gdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXJyZW50TW9udGhDaGFycy50b1N0cmluZygpKS5zZXREaXNhYmxlZCh0cnVlKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnXHVEODNEXHVERDE0IFVzYWdlIFdhcm5pbmcgVGhyZXNob2xkICglKScpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnTm90aWZ5IG1lIHdoZW4gdXNhZ2UgcmVhY2hlcyB0aGlzIHBlcmNlbnRhZ2UgKDAtMTAwKS4nKVxyXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiODAuMDBcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWxlcnRUaHJlc2hvbGRQZXJjZW50LnRvRml4ZWQoMikpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbnVtID0gcGFyc2VGbG9hdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihudW0pKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudW0gPCAwKSBudW0gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVtID4gMTAwKSBudW0gPSAxMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hbGVydFRocmVzaG9sZFBlcmNlbnQgPSBudW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlciA9PT0gJ2xvY2FsX29sbGFtYScpIHtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoJ1x1RDgzRVx1REQxNiBPbGxhbWEgTW9kZWwnKS5hZGRUZXh0KHQgPT4gdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFNb2RlbCkub25DaGFuZ2UoYXN5bmMgdiA9PiB7IHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYU1vZGVsID0gdjsgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IH0pKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnXHVEODNDXHVERkE4IEFwcGVhcmFuY2UnfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdUYXJnZXQgTGFuZ3VhZ2UgKEdsb2JhbCknKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc29ydGVkTGFuZ3MgPSBPYmplY3QuZW50cmllcyhMQU5HVUFHRVMpLnNvcnQoKGEsIGIpID0+IGFbMV0ubG9jYWxlQ29tcGFyZShiWzFdKSk7XHJcbiAgICAgICAgICAgICAgICBzb3J0ZWRMYW5ncy5mb3JFYWNoKChbY29kZSwgbmFtZV0pID0+IGRyb3Bkb3duLmFkZE9wdGlvbihjb2RlLCBuYW1lKSk7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YXJnZXRMYW5nKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4geyB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YXJnZXRMYW5nID0gdmFsdWU7IGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdUZXh0IENvbG9yJykuYWRkQ29sb3JQaWNrZXIoYyA9PiBjLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlY29uZGFyeUNvbG9yKS5vbkNoYW5nZShhc3luYyB2ID0+IHsgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2Vjb25kYXJ5Q29sb3IgPSB2OyBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGNsZWFyRGF0YWJhc2UoKSB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZWRUcmFuc2xhdGlvbnMgPSB7fTtcclxuICAgICAgICB0aGlzLnBsdWdpbi50cmFuc2xhdGlvbkNhY2hlLmNsZWFyKCk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgbmV3IE5vdGljZSgnXHUyNzA1IE1lbW9yeSBjbGVhcmVkIHN1Y2Nlc3NmdWxseS4nKTtcclxuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLnVwZGF0ZU9wdGlvbnMoKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgTGFuZ3VhZ2VTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XHJcbiAgICBwbHVnaW46IEludGVybGluZWFyUGx1Z2luO1xyXG4gICAgZmlsZTogVEZpbGU7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSW50ZXJsaW5lYXJQbHVnaW4sIGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xyXG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJCdXNjYXIgaWRpb21hIChlai4gU3BhbmlzaCwgZW4sIGZyLi4uKVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5TG93ZXIgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhMQU5HVUFHRVMpLmZpbHRlcihjb2RlID0+IFxyXG4gICAgICAgICAgICBMQU5HVUFHRVNbY29kZV0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeUxvd2VyKSB8fCBjb2RlLmluY2x1ZGVzKHF1ZXJ5TG93ZXIpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJTdWdnZXN0aW9uKGNvZGU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBMQU5HVUFHRVNbY29kZV0gfSk7XHJcbiAgICAgICAgZWwuY3JlYXRlRWwoXCJzbWFsbFwiLCB7IHRleHQ6IGBDXHUwMEYzZGlnbzogJHtjb2RlfWAsIGNsczogXCJ0ZXh0LW11dGVkXCIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKGNvZGU6IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIodGhpcy5maWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICAgICAgZnJvbnRtYXR0ZXJbJ3RhcmdldF9sYW5nJ10gPSBjb2RlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG5ldyBOb3RpY2UoYFx1RDgzQ1x1REZBRiBJZGlvbWEgZXN0YWJsZWNpZG8gYTogJHtMQU5HVUFHRVNbY29kZV19IHBhcmEgZXN0YSBub3RhYCk7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS51cGRhdGVPcHRpb25zKCk7IFxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzbGVlcChtczogbnVtYmVyKSB7IHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTsgfSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBaUg7QUFDakgsbUJBQXVEO0FBQ3ZELGtCQUFrRTtBQUdsRSxJQUFNLFlBQW9DO0FBQUEsRUFDdEMsTUFBTTtBQUFBLEVBQVcsTUFBTTtBQUFBLEVBQVcsTUFBTTtBQUFBLEVBQVUsTUFBTTtBQUFBLEVBQ3hELE1BQU07QUFBQSxFQUFXLE1BQU07QUFBQSxFQUFjLE1BQU07QUFBQSxFQUFXLE1BQU07QUFBQSxFQUM1RCxNQUFNO0FBQUEsRUFBd0IsTUFBTTtBQUFBLEVBQVUsTUFBTTtBQUFBLEVBQ3BELE1BQU07QUFBQSxFQUFTLE1BQU07QUFBQSxFQUFXLE1BQU07QUFBQSxFQUFTLE1BQU07QUFBQSxFQUNyRCxNQUFNO0FBQUEsRUFBVyxNQUFNO0FBQUEsRUFBYSxNQUFNO0FBQUEsRUFBVyxNQUFNO0FBQUEsRUFDM0QsTUFBTTtBQUNWO0FBb0JBLElBQU0sbUJBQXdDO0FBQUEsRUFDMUMsVUFBVTtBQUFBLEVBQ1YsWUFBWTtBQUFBLEVBQ1osUUFBUTtBQUFBLEVBQ1IsYUFBYTtBQUFBLEVBQ2IsZ0JBQWdCO0FBQUEsRUFDaEIsZUFBZTtBQUFBLEVBQ2YsVUFBVTtBQUFB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LFFBQVEsWUFBWSxFQUFFLGVBQWUsT0FBSyxFQUFFLFNBQVMsS0FBSyxPQUFPLFNBQVMsY0FBYyxFQUFFLFNBQVMsT0FBTSxNQUFLO0FBQUUsV0FBSyxPQUFPLFNBQVMsaUJBQWlCO0FBQUcsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQUcsQ0FBQyxDQUFDO0FBQUEsRUFDMU47QUFBQSxFQUVBLE1BQU0sZ0JBQWdCO0FBQ2xCLFNBQUssT0FBTyxTQUFTLG9CQUFvQixDQUFDO0FBQzFDLFNBQUssT0FBTyxpQkFBaUIsTUFBTTtBQUNuQyxVQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFFBQUksdUJBQU8scUNBQWdDO0FBQzNDLFNBQUssT0FBTyxJQUFJLFVBQVUsY0FBYztBQUFBLEVBQzVDO0FBQ0o7QUFFQSxJQUFNLHVCQUFOLGNBQW1DLDZCQUFxQjtBQUFBLEVBSXBELFlBQVksS0FBVSxRQUEyQixNQUFhO0FBQzFELFVBQU0sR0FBRztBQUNULFNBQUssU0FBUztBQUNkLFNBQUssT0FBTztBQUNaLFNBQUssZUFBZSx3Q0FBd0M7QUFBQSxFQUNoRTtBQUFBLEVBRUEsZUFBZSxPQUF5QjtBQUNwQyxVQUFNLGFBQWEsTUFBTSxZQUFZO0FBQ3JDLFdBQU8sT0FBTyxLQUFLLFNBQVMsRUFBRTtBQUFBLE1BQU8sVUFDakMsVUFBVSxJQUFJLEVBQUUsWUFBWSxFQUFFLFNBQVMsVUFBVSxLQUFLLEtBQUssU0FBUyxVQUFVO0FBQUEsSUFDbEY7QUFBQSxFQUNKO0FBQUEsRUFFQSxpQkFBaUIsTUFBYyxJQUFpQjtBQUM1QyxPQUFHLFNBQVMsT0FBTyxFQUFFLE1BQU0sVUFBVSxJQUFJLEVBQUUsQ0FBQztBQUM1QyxPQUFHLFNBQVMsU0FBUyxFQUFFLE1BQU0sY0FBVyxRQUFRLEtBQUssYUFBYSxDQUFDO0FBQUEsRUFDdkU7QUFBQSxFQUVBLE1BQU0sbUJBQW1CLE1BQWMsS0FBaUM7QUFDcEUsVUFBTSxLQUFLLE9BQU8sSUFBSSxZQUFZLG1CQUFtQixLQUFLLE1BQU0sQ0FBQyxnQkFBZ0I7QUFDN0Usa0JBQVksYUFBYSxJQUFJO0FBQUEsSUFDakMsQ0FBQztBQUNELFFBQUksdUJBQU8sbUNBQTRCLFVBQVUsSUFBSSxrQkFBa0I7QUFDdkUsU0FBSyxPQUFPLElBQUksVUFBVSxjQUFjO0FBQUEsRUFDNUM7QUFDSjtBQUVBLFNBQVMsTUFBTSxJQUFZO0FBQUUsU0FBTyxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsRUFBRSxDQUFDO0FBQUc7IiwKICAibmFtZXMiOiBbXQp9Cg==
